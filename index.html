<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fraction Flow</title>

<style>
* { box-sizing: border-box; }

body {
  margin:0;
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, #0f172a, #1e293b);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* SCREENS */
.screen {
  display:none;
  width:800px;
  max-width:95%;
  padding:40px;
  border-radius:20px;
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(10px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.4);
  animation: fadeIn 0.4s ease;
}

.active { display:block; }

@keyframes fadeIn {
  from { opacity:0; transform: translateY(10px); }
  to { opacity:1; transform: translateY(0); }
}

/* HEADINGS */
h1 { font-size:36px; margin-bottom:10px; }
h2 { margin-bottom:20px; }

/* BUTTONS */
button {
  padding:14px 24px;
  font-size:16px;
  cursor:pointer;
  border:none;
  border-radius:12px;
  background: linear-gradient(45deg, #38bdf8, #22d3ee);
  color:#0f172a;
  font-weight:bold;
  transition: all 0.2s ease;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(0,0,0,0.3);
}

button:active {
  transform: scale(0.95);
}

/* HUD */
#hud {
  display:flex;
  justify-content:space-between;
  padding:10px 20px;
  margin-bottom:20px;
  background: rgba(255,255,255,0.08);
  border-radius:12px;
}

/* BAR */
#barContainer {
  width:100%;
  height:50px;
  background:#0f172a;
  border-radius:30px;
  overflow:hidden;
  margin:30px 0;
  border:2px solid rgba(255,255,255,0.1);
}

#bar {
  height:100%;
  width:0%;
  background: linear-gradient(90deg, #22c55e, #4ade80);
  box-shadow: 0 0 15px #22c55e;
  transition:width 0.1s;
}

/* TARGET */
#target {
  font-size:22px;
  margin-top:15px;
}

ul {
  text-align:left;
  max-width:500px;
  margin:20px auto;
  line-height:1.6;
}

.star {
  font-size:26px;
  color:gold;
}
</style>
</head>

<body>

<!-- START -->
<div id="start" class="screen active">
  <h1>üåä Fraction Flow</h1>
  <p>Control the flow and stop at the correct fraction!</p>
  <br>
  <button onclick="showInstructions()">Start Game</button>
</div>

<!-- INSTRUCTIONS -->
<div id="instruction" class="screen">
  <h2>üìã How To Play</h2>
  <ul>
    <li>Hold the button to fill the bar.</li>
    <li>Release when the bar matches the target fraction.</li>
    <li>You have 30 seconds to score as many points as possible.</li>
    <li>Each correct answer increases the level difficulty.</li>
    <li>If you're within 5% of the accuracy ‚Äî you score!</li>
  </ul>
  <br>
  <button onclick="startGame()">Begin Game</button>
</div>

<!-- GAME -->
<div id="game" class="screen">
  <div id="hud">
    <div>‚è± <span id="time">30</span></div>
    <div>‚≠ê <span id="points">0</span></div>
    <div>Level <span id="level">1</span></div>
  </div>

  <div id="barContainer">
    <div id="bar"></div>
  </div>

  <div id="target">
    Target: <b><span id="fraction"></span></b>
  </div>

  <br>
  <button onmousedown="fill=true" onmouseup="stopFill()">Hold to Fill</button>
</div>

<!-- END -->
<div id="end" class="screen">
  <h2>‚è≥ Time's Up!</h2>
  <p>Your Score: <span id="finalScore"></span></p>
  <p id="stars"></p>
  <br>
  <button onclick="location.reload()">Play Again</button>
</div>

<!-- FINISH -->
<div id="finish" class="screen">
  <h2>üéâ All Levels Completed!</h2>
  <p>Final Score: <span id="finalScore2"></span></p>
  <br>
  <button onclick="location.reload()">Restart</button>
</div>

<script>
let fill=false, width=0, points=0, time=30, timer;
let level=1, maxLevel=4;
let targetFraction;

function randomFraction() {
  let denom = level + 2;
  let num = Math.floor(Math.random() * (denom - 1)) + 1;
  return { num, denom, value: (num/denom)*100 };
}

function showInstructions(){
  show('instruction');
}

function startGame() {
  show('game');
  time = 30;
  document.getElementById('time').textContent = time;
  nextLevel();

  timer = setInterval(() => {
    time--;
    document.getElementById('time').textContent = time;
    if (time <= 0) endGame();
  }, 1000);
}

function nextLevel() {
  if (level > maxLevel) return finishGame();
  document.getElementById('level').textContent = level;
  targetFraction = randomFraction();
  document.getElementById('fraction').textContent =
    `${targetFraction.num}/${targetFraction.denom}`;
}

setInterval(() => {
  if (fill) {
    width += 0.5 + level * 0.2;
    if (width >= 100) width = 100;
    document.getElementById('bar').style.width = width + '%';
  }
}, 30);

function stopFill() {
  fill = false;
  let diff = Math.abs(width - targetFraction.value);

  if (diff < 5) {
    points += 20;
    level++;
    nextLevel();
  } else {
    points = Math.max(0, points - 5);
  }

  width = 0;
  document.getElementById('bar').style.width = '0%';
  document.getElementById('points').textContent = points;
}

function endGame() {
  clearInterval(timer);
  show('end');
  document.getElementById('finalScore').textContent = points;
  document.getElementById('stars').innerHTML =
    '‚≠ê'.repeat(Math.min(3, Math.floor(points/40)));
}

function finishGame() {
  clearInterval(timer);
  show('finish');
  document.getElementById('finalScore2').textContent = points;
}

function show(id) {
  document.querySelectorAll('.screen').forEach(s =>
    s.classList.remove('active')
  );
  document.getElementById(id).classList.add('active');
}
</script>

</body>
</html>
